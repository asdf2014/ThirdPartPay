/*Dependencies: jQuery, jQuery UI (Slider), Video.js, ImagesLoaded */
!function(i){"use strict";"function"==typeof define&&define.amd?define(["jquery","videojs","imagesloaded","jquery-ui"],i):i(jQuery,videojs)}(function(i,o){i.BigVideo=function(e,t){function n(){var o=i("body"),e=T.find(".big-video-wrap"),t=e.width(),n=e.height(),d=t/n;S.container.is(o)&&i("html,body").css("height",i(window).height()>o.css("height","auto").height()?"100%":"auto"),m>d?"video"===g?(f.width(n*m).height(n),S.shrinkable?F.css("top",-(t/m-n)/2).css("left",0).css("height",t/m):F.css("top",0).css("left",-(n*m-t)/2).css("height",n),T.find(u+"_html5_api").css("width",n*m).css("height",n),T.find("object[id*=_flash_api]").parent().css("width",i(window).height()*m).css("height",i(window).height()),T.find("video").css("width","")):T.find(".big-video-image").css({width:"auto",height:n,top:0,left:-(n*m-t)/2}):"video"===g?(f.width(t).height(t/m),F.css("top",-(t/m-n)/2).css("left",0).css("height",t/m),T.find(u+"_html5_api").css("width",T.find(u+"_html5_api").parent().width()+"px").css("height","auto"),T.find("object[id*=_flash_api]").parent().css("width",i(window).width()).css("height",i(window).width()/m),T.find("video").css("width","100%")):T.find(".big-video-image").css({width:t,height:"auto",top:-(t/m-n)/2,left:0})}function d(){var o=['<div class="big-video-control-container">','<div class="big-video-control">','<a href="#" class="big-video-control-play"></a>','<div class="big-video-control-middle">','<div class="big-video-control-bar">','<div class="big-video-control-bound-left"></div>','<div class="big-video-control-progress"></div>','<div class="big-video-control-track"></div>','<div class="big-video-control-bound-right"></div>',"</div>","</div>",'<div class="big-video-control-timer"></div>',"</div>","</div>"].join("");T.append(o),T.find(".big-video-control-container").css("display","none"),T.find(".big-video-control-timer").css("display","none"),T.find(".big-video-control-track").slider({animate:!0,step:.01,slide:function(i,o){j=!0,T.find(".big-video-control-progress").css("width",o.value-.16+"%"),f.currentTime(o.value/100*f.duration())},stop:function(i,o){j=!1,f.currentTime(o.value/100*f.duration())}}),T.find(".big-video-control-bar").click(function(o){f.currentTime(o.offsetX/i(this).width()*f.duration())}),T.find(".big-video-control-play").click(function(i){i.preventDefault(),a("toggle")}),f.on("timeupdate",function(){if(!j&&f.currentTime()/f.duration()){var i=f.currentTime(),o=Math.floor(i/60),e=Math.floor(i)-60*o;10>e&&(e="0"+e);var t=f.currentTime()/f.duration()*100;T.find(".big-video-control-track").slider("value",t),T.find(".big-video-control-progress").css("width",t-.16+"%"),T.find(".big-video-control-timer").text(o+":"+e+"/"+y)}})}function a(i){var o=i||"toggle";"toggle"===o&&(o=k?"pause":"play"),"pause"===o?(f.pause(),T.find(".big-video-control-play").css("background-position","-16px"),k=!1):"play"===o?(f.play(),T.find(".big-video-control-play").css("background-position","0"),k=!0):"skip"===o&&r()}function s(){f.play(),S.container.off("click",s)}function r(){v++,v===A.length&&(v=0),c(A[v])}function c(i){F.css("display","block"),g="video",f.src(i),k=!0,L?(T.find(".big-video-control-container").css("display","none"),f.ready(function(){f.volume(0)}),doLoop=!0):(T.find(".big-video-control-container").css("display","block"),f.ready(function(){f.volume(w)}),doLoop=!0),T.find(".big-video-image").css("display","none"),F.css("display","block")}function l(o){T.find(".big-video-image").remove(),f.pause(),F.css("display","none"),T.find(".big-video-control-container").css("display","none"),g="image";var e=i('<img class="big-video-image" src='+o+" />");b.append(e),T.find(".big-video-image").imagesLoaded(function(){m=T.find(".big-video-image").width()/T.find(".big-video-image").height(),n()})}var f,v,g,h={useFlashForFirefox:!1,forceAutoplay:!1,controls:!1,doLoop:!0,ambient:!0,container:i(t?t:"body"),shrinkable:!1,poster:""},p=this,u=".big-video-vid",b=i('<div class="big-video-wrap"></div>'),m=(i(""),16/9),y=0,w=.8,_=!1,j=!1,k=!1,x=!1,L=!1,A=[],S=i.extend({},h,e),T=S.container,F=T.find(u);L=S.ambient,p.init=function(){if(!_){S.container.prepend(b);var e=S.forceAutoplay?"autoplay":"";f=i('<video class="'+u.substr(1)+'" class="video-js vjs-default-skin" preload="auto" data-setup="{}" '+e+' webkit-playsinline poster="'+S.poster+'"></video>'),f.css("position","absolute"),b.append(f),F=T.find(u);var t=["html5","flash"],a=navigator.userAgent.toLowerCase(),c=-1!=a.indexOf("firefox");S.useFlashForFirefox&&c&&(t=["flash","html5"]),f=o(F[0],{controls:!1,autoplay:!0,preload:"auto",techOrder:t}),S.controls&&d(),n(),_=!0,k=!1,S.forceAutoplay&&i("body").on("click",s),T.find("object[id*=_flash_api]").attr("scale","noborder").attr("width","100%").attr("height","100%"),i(window).on("resize.bigvideo",function(){n()}),f.on("playing",function(o){"undefined"!=typeof tbLocalScript&&""===tbLocalScript.isTouch&&-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&i(o.target).attr("poster","")}),f.on("loadedmetadata",function(){m=T.find("object[id*=_flash_api]").length?T.find("object[id*=_flash_api]")[0].vjs_getProperty("videoWidth")/T.find("object[id*=_flash_api]")[0].vjs_getProperty("videoHeight"):T.find("video").prop("videoWidth")/T.find("video").prop("videoHeight"),n();var i=Math.round(f.duration()),o=Math.floor(i/60),e=i-60*o;10>e&&(e="0"+e),y=o+":"+e}),f.on("ended",function(){S.doLoop&&(f.currentTime(0),f.play()),x&&r()})}},p.show=function(i,o){if(void 0===o&&(o={}),i||""===T.data("video")||(i=T.data("video")),L=o.ambient?o.ambient===!0:S.ambient,L&&o.doLoop&&(S.doLoop=!0),"string"==typeof i){var e=i.substring(i.lastIndexOf(".")+1);"jpg"===e||"gif"===e||"png"===e?l(i):(o.altSource&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(i=o.altSource),c(i),o.onShown&&o.onShown(),x=!1)}else A=i,v=0,c(A[v]),o.onShown&&o.onShown(),x=!0},p.getPlayer=function(){return f},p.remove=p.dispose=function(){_=!1,b.remove(),i(window).off("resize.bigvideo"),f&&(f.off("loadedmetadata"),f.off("ended"),f.dispose())},p.triggerPlayer=function(i){a(i)}},i.fn.bigvideo=function(o){if("string"==typeof o){var e=Array.prototype.slice.call(arguments,1);this.each(function(){var t=i.data(this,"bigvideo");return t?i.isFunction(t[o])&&"_"!==o.charAt(0)?void t[o].apply(t,e):void i.error('No such method "'+o+'" for bigvideo instance'):void i.error('Cannot call methods on bigvideo prior to initialization; Attempted to call method "'+o+'"')})}else this.each(function(){i.data(this,"bigvideo",new i.BigVideo(o,this))});return this}});